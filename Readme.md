# Отчет
## "Часть 1:Разработка API для модели классификации изображений (Ермолаев Александр)"

### 2. Выбор и описание модели

**Выбранная модель:** ResNet50

**Обоснование выбора:**
- Предобученная модель на dataset ImageNet
- Способность распознавать 1000 различных категорий объектов
- Хороший баланс между точностью и производительностью
- Широкая поддержка в сообществе и хорошая документация

**Технические характеристики модели:**
- Архитектура: Residual Network с 50 слоями
- Размер входного изображения: 224×224 пикселей
- Количество классов: 1000
- Фреймворк: TensorFlow/Keras

### 3. Реализация системы

#### 3.1. Структура проекта

Спроектирована следующая файловая структура:
```
image-classification-api/
├── app/
│   ├── main.py              # Основное приложение FastAPI
│   ├── classifier.py        # Класс для работы с моделью
│   └── schemas.py           # Схемы данных Pydantic
├── tests/
│   └── test_api.py          # Тесты API
└── requirements.txt         # Зависимости проекта
```

#### 3.2. Ключевые компоненты реализации

**Класс ImageClassifier (classifier.py):**
- Инкапсулирует всю логику работы с моделью
- Реализует методы для загрузки изображений из файлов и URL
- Выполняет предобработку изображений (ресайз, нормализация)
- Обеспечивает взаимодействие с моделью ResNet50

**FastAPI приложение (main.py):**
- Реализует три основных эндпоинта:
  - `GET /health` - проверка состояния системы
  - `POST /predict` - классификация из файла
  - `POST /predict/url` - классификация из URL
- Обеспечивает валидацию входных данных
- Предоставляет автоматическую документацию Swagger

**Схемы данных (schemas.py):**
- Определяют структуру запросов и ответов
- Обеспечивают типобезопасность и валидацию
- Упрощают взаимодействие с API

### 4. Часть 2:Тестирование системы (Ермолаев Александр)

#### 4.1. Методы тестирования

**Модульное тестирование:**
- Проверка загрузки и инициализации модели
- Тестирование методов предобработки изображений
- Валидация форматов входных данных

**Интеграционное тестирование:**
```python
# Пример теста API
def test_predict_endpoint():
    with open("test_image.jpg", "rb") as f:
        response = client.post("/predict", files={"file": f})
    assert response.status_code == 200
    data = response.json()
    assert data["status"] == "success"
```

**Ручное тестирование через Swagger UI:**
- Тестирование всех эндпоинтов через интерактивную документацию
- Проверка обработки различных форматов изображений
- Тестирование граничных случаев и обработки ошибок

#### 4.2. Результаты тестирования

**Успешные сценарии:**
- Модель успешно загружается при старте приложения
- API корректно обрабатывает JPEG, PNG изображения
- Система возвращает топ-5 предсказаний с вероятностями
- Обработка изображений через URL работает стабильно

**Обработка ошибок:**
- Валидация не-image файлов
- Обработка битых изображений
- Таймауты при загрузке по URL
- Корректные HTTP статусы при ошибках


### 6. Возникшие трудности и их решение

#### 6.1. Проблема: Обработка различных форматов изображений
**Трудность:** Некорректная работа с некоторыми типами изображений
**Решение:** Добавление конвертации в RGB формат и улучшение обработки исключений

#### 6.2. Проблема: Производительность при множественных запросах
**Трудность:** Долгая обработка при одновременных запросах
**Решение:** Оптимизация пайплайна предобработки и использование асинхронности

### 7. Результаты работы

✅ Реализовано REST API с помощью FastAPI  
✅ Обеспечена поддержка загрузки изображений через файлы и URL  
✅ Реализована система тестирования и валидации  

### 8. Использованные технологии и библиотеки

- **Машинное обучение:** TensorFlow, Keras, ResNet50
- **Веб-фреймворк:** FastAPI
- **Обработка изображений:** Pillow, OpenCV
- **Валидация данных:** Pydantic
- **Тестирование:** pytest, requests
- **Сервер:** Uvicorn
